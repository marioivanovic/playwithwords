{"ast":null,"code":"import { WebPlugin, CapacitorException } from '@capacitor/core';\nimport { CameraSource, CameraDirection } from './definitions';\nexport class CameraWeb extends WebPlugin {\n  async getPhoto(options) {\n    // eslint-disable-next-line no-async-promise-executor\n    return new Promise(async (resolve, reject) => {\n      if (options.webUseInput || options.source === CameraSource.Photos) {\n        this.fileInputExperience(options, resolve);\n      } else if (options.source === CameraSource.Prompt) {\n        let actionSheet = document.querySelector('pwa-action-sheet');\n\n        if (!actionSheet) {\n          actionSheet = document.createElement('pwa-action-sheet');\n          document.body.appendChild(actionSheet);\n        }\n\n        actionSheet.header = options.promptLabelHeader || 'Photo';\n        actionSheet.cancelable = false;\n        actionSheet.options = [{\n          title: options.promptLabelPhoto || 'From Photos'\n        }, {\n          title: options.promptLabelPicture || 'Take Picture'\n        }];\n        actionSheet.addEventListener('onSelection', async e => {\n          const selection = e.detail;\n\n          if (selection === 0) {\n            this.fileInputExperience(options, resolve);\n          } else {\n            this.cameraExperience(options, resolve, reject);\n          }\n        });\n      } else {\n        this.cameraExperience(options, resolve, reject);\n      }\n    });\n  }\n\n  async pickImages(_options) {\n    // eslint-disable-next-line no-async-promise-executor\n    return new Promise(async resolve => {\n      this.multipleFileInputExperience(resolve);\n    });\n  }\n\n  async cameraExperience(options, resolve, reject) {\n    if (customElements.get('pwa-camera-modal')) {\n      const cameraModal = document.createElement('pwa-camera-modal');\n      cameraModal.facingMode = options.direction === CameraDirection.Front ? 'user' : 'environment';\n      document.body.appendChild(cameraModal);\n\n      try {\n        await cameraModal.componentOnReady();\n        cameraModal.addEventListener('onPhoto', async e => {\n          const photo = e.detail;\n\n          if (photo === null) {\n            reject(new CapacitorException('User cancelled photos app'));\n          } else if (photo instanceof Error) {\n            reject(photo);\n          } else {\n            resolve((await this._getCameraPhoto(photo, options)));\n          }\n\n          cameraModal.dismiss();\n          document.body.removeChild(cameraModal);\n        });\n        cameraModal.present();\n      } catch (e) {\n        this.fileInputExperience(options, resolve);\n      }\n    } else {\n      console.error(`Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/pwa-elements.`);\n      this.fileInputExperience(options, resolve);\n    }\n  }\n\n  fileInputExperience(options, resolve) {\n    let input = document.querySelector('#_capacitor-camera-input');\n\n    const cleanup = () => {\n      var _a;\n\n      (_a = input.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(input);\n    };\n\n    if (!input) {\n      input = document.createElement('input');\n      input.id = '_capacitor-camera-input';\n      input.type = 'file';\n      input.hidden = true;\n      document.body.appendChild(input);\n      input.addEventListener('change', _e => {\n        const file = input.files[0];\n        let format = 'jpeg';\n\n        if (file.type === 'image/png') {\n          format = 'png';\n        } else if (file.type === 'image/gif') {\n          format = 'gif';\n        }\n\n        if (options.resultType === 'dataUrl' || options.resultType === 'base64') {\n          const reader = new FileReader();\n          reader.addEventListener('load', () => {\n            if (options.resultType === 'dataUrl') {\n              resolve({\n                dataUrl: reader.result,\n                format\n              });\n            } else if (options.resultType === 'base64') {\n              const b64 = reader.result.split(',')[1];\n              resolve({\n                base64String: b64,\n                format\n              });\n            }\n\n            cleanup();\n          });\n          reader.readAsDataURL(file);\n        } else {\n          resolve({\n            webPath: URL.createObjectURL(file),\n            format: format\n          });\n          cleanup();\n        }\n      });\n    }\n\n    input.accept = 'image/*';\n    input.capture = true;\n\n    if (options.source === CameraSource.Photos || options.source === CameraSource.Prompt) {\n      input.removeAttribute('capture');\n    } else if (options.direction === CameraDirection.Front) {\n      input.capture = 'user';\n    } else if (options.direction === CameraDirection.Rear) {\n      input.capture = 'environment';\n    }\n\n    input.click();\n  }\n\n  multipleFileInputExperience(resolve) {\n    let input = document.querySelector('#_capacitor-camera-input-multiple');\n\n    const cleanup = () => {\n      var _a;\n\n      (_a = input.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(input);\n    };\n\n    if (!input) {\n      input = document.createElement('input');\n      input.id = '_capacitor-camera-input-multiple';\n      input.type = 'file';\n      input.hidden = true;\n      input.multiple = true;\n      document.body.appendChild(input);\n      input.addEventListener('change', _e => {\n        const photos = []; // eslint-disable-next-line @typescript-eslint/prefer-for-of\n\n        for (let i = 0; i < input.files.length; i++) {\n          const file = input.files[i];\n          let format = 'jpeg';\n\n          if (file.type === 'image/png') {\n            format = 'png';\n          } else if (file.type === 'image/gif') {\n            format = 'gif';\n          }\n\n          photos.push({\n            webPath: URL.createObjectURL(file),\n            format: format\n          });\n        }\n\n        resolve({\n          photos\n        });\n        cleanup();\n      });\n    }\n\n    input.accept = 'image/*';\n    input.click();\n  }\n\n  _getCameraPhoto(photo, options) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      const format = photo.type.split('/')[1];\n\n      if (options.resultType === 'uri') {\n        resolve({\n          webPath: URL.createObjectURL(photo),\n          format: format,\n          saved: false\n        });\n      } else {\n        reader.readAsDataURL(photo);\n\n        reader.onloadend = () => {\n          const r = reader.result;\n\n          if (options.resultType === 'dataUrl') {\n            resolve({\n              dataUrl: r,\n              format: format,\n              saved: false\n            });\n          } else {\n            resolve({\n              base64String: r.split(',')[1],\n              format: format,\n              saved: false\n            });\n          }\n        };\n\n        reader.onerror = e => {\n          reject(e);\n        };\n      }\n    });\n  }\n\n  async checkPermissions() {\n    if (typeof navigator === 'undefined' || !navigator.permissions) {\n      throw this.unavailable('Permissions API not available in this browser');\n    }\n\n    try {\n      // https://developer.mozilla.org/en-US/docs/Web/API/Permissions/query\n      // the specific permissions that are supported varies among browsers that implement the\n      // permissions API, so we need a try/catch in case 'camera' is invalid\n      const permission = await window.navigator.permissions.query({\n        name: 'camera'\n      });\n      return {\n        camera: permission.state,\n        photos: 'granted'\n      };\n    } catch (_a) {\n      throw this.unavailable('Camera permissions are not available in this browser');\n    }\n  }\n\n  async requestPermissions() {\n    throw this.unimplemented('Not implemented on web.');\n  }\n\n}\nconst Camera = new CameraWeb();\nexport { Camera };","map":{"version":3,"sources":["../../src/web.ts"],"names":[],"mappings":"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","sourcesContent":["import { WebPlugin, CapacitorException } from '@capacitor/core';\n\nimport { CameraSource, CameraDirection } from './definitions';\nimport type {\n  CameraPlugin,\n  GalleryImageOptions,\n  GalleryPhotos,\n  ImageOptions,\n  PermissionStatus,\n  Photo,\n} from './definitions';\n\nexport class CameraWeb extends WebPlugin implements CameraPlugin {\n  async getPhoto(options: ImageOptions): Promise<Photo> {\n    // eslint-disable-next-line no-async-promise-executor\n    return new Promise<Photo>(async (resolve, reject) => {\n      if (options.webUseInput || options.source === CameraSource.Photos) {\n        this.fileInputExperience(options, resolve);\n      } else if (options.source === CameraSource.Prompt) {\n        let actionSheet: any = document.querySelector('pwa-action-sheet');\n        if (!actionSheet) {\n          actionSheet = document.createElement('pwa-action-sheet');\n          document.body.appendChild(actionSheet);\n        }\n        actionSheet.header = options.promptLabelHeader || 'Photo';\n        actionSheet.cancelable = false;\n        actionSheet.options = [\n          { title: options.promptLabelPhoto || 'From Photos' },\n          { title: options.promptLabelPicture || 'Take Picture' },\n        ];\n        actionSheet.addEventListener('onSelection', async (e: any) => {\n          const selection = e.detail;\n          if (selection === 0) {\n            this.fileInputExperience(options, resolve);\n          } else {\n            this.cameraExperience(options, resolve, reject);\n          }\n        });\n      } else {\n        this.cameraExperience(options, resolve, reject);\n      }\n    });\n  }\n\n  async pickImages(_options: GalleryImageOptions): Promise<GalleryPhotos> {\n    // eslint-disable-next-line no-async-promise-executor\n    return new Promise<GalleryPhotos>(async resolve => {\n      this.multipleFileInputExperience(resolve);\n    });\n  }\n\n  private async cameraExperience(\n    options: ImageOptions,\n    resolve: any,\n    reject: any,\n  ) {\n    if (customElements.get('pwa-camera-modal')) {\n      const cameraModal: any = document.createElement('pwa-camera-modal');\n      cameraModal.facingMode =\n        options.direction === CameraDirection.Front ? 'user' : 'environment';\n      document.body.appendChild(cameraModal);\n      try {\n        await cameraModal.componentOnReady();\n        cameraModal.addEventListener('onPhoto', async (e: any) => {\n          const photo = e.detail;\n\n          if (photo === null) {\n            reject(new CapacitorException('User cancelled photos app'));\n          } else if (photo instanceof Error) {\n            reject(photo);\n          } else {\n            resolve(await this._getCameraPhoto(photo, options));\n          }\n\n          cameraModal.dismiss();\n          document.body.removeChild(cameraModal);\n        });\n\n        cameraModal.present();\n      } catch (e) {\n        this.fileInputExperience(options, resolve);\n      }\n    } else {\n      console.error(\n        `Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/pwa-elements.`,\n      );\n      this.fileInputExperience(options, resolve);\n    }\n  }\n\n  private fileInputExperience(options: ImageOptions, resolve: any) {\n    let input = document.querySelector(\n      '#_capacitor-camera-input',\n    ) as HTMLInputElement;\n\n    const cleanup = () => {\n      input.parentNode?.removeChild(input);\n    };\n\n    if (!input) {\n      input = document.createElement('input') as HTMLInputElement;\n      input.id = '_capacitor-camera-input';\n      input.type = 'file';\n      input.hidden = true;\n      document.body.appendChild(input);\n      input.addEventListener('change', (_e: any) => {\n        const file = input.files![0];\n        let format = 'jpeg';\n\n        if (file.type === 'image/png') {\n          format = 'png';\n        } else if (file.type === 'image/gif') {\n          format = 'gif';\n        }\n\n        if (\n          options.resultType === 'dataUrl' ||\n          options.resultType === 'base64'\n        ) {\n          const reader = new FileReader();\n\n          reader.addEventListener('load', () => {\n            if (options.resultType === 'dataUrl') {\n              resolve({\n                dataUrl: reader.result,\n                format,\n              } as Photo);\n            } else if (options.resultType === 'base64') {\n              const b64 = (reader.result as string).split(',')[1];\n              resolve({\n                base64String: b64,\n                format,\n              } as Photo);\n            }\n\n            cleanup();\n          });\n\n          reader.readAsDataURL(file);\n        } else {\n          resolve({\n            webPath: URL.createObjectURL(file),\n            format: format,\n          });\n          cleanup();\n        }\n      });\n    }\n\n    input.accept = 'image/*';\n    (input as any).capture = true;\n\n    if (\n      options.source === CameraSource.Photos ||\n      options.source === CameraSource.Prompt\n    ) {\n      input.removeAttribute('capture');\n    } else if (options.direction === CameraDirection.Front) {\n      (input as any).capture = 'user';\n    } else if (options.direction === CameraDirection.Rear) {\n      (input as any).capture = 'environment';\n    }\n\n    input.click();\n  }\n\n  private multipleFileInputExperience(resolve: any) {\n    let input = document.querySelector(\n      '#_capacitor-camera-input-multiple',\n    ) as HTMLInputElement;\n\n    const cleanup = () => {\n      input.parentNode?.removeChild(input);\n    };\n\n    if (!input) {\n      input = document.createElement('input') as HTMLInputElement;\n      input.id = '_capacitor-camera-input-multiple';\n      input.type = 'file';\n      input.hidden = true;\n      input.multiple = true;\n      document.body.appendChild(input);\n      input.addEventListener('change', (_e: any) => {\n        const photos = [];\n        // eslint-disable-next-line @typescript-eslint/prefer-for-of\n        for (let i = 0; i < input.files!.length; i++) {\n          const file = input.files![i];\n          let format = 'jpeg';\n\n          if (file.type === 'image/png') {\n            format = 'png';\n          } else if (file.type === 'image/gif') {\n            format = 'gif';\n          }\n          photos.push({\n            webPath: URL.createObjectURL(file),\n            format: format,\n          });\n        }\n        resolve({ photos });\n        cleanup();\n      });\n    }\n\n    input.accept = 'image/*';\n\n    input.click();\n  }\n\n  private _getCameraPhoto(photo: Blob, options: ImageOptions) {\n    return new Promise<Photo>((resolve, reject) => {\n      const reader = new FileReader();\n      const format = photo.type.split('/')[1];\n      if (options.resultType === 'uri') {\n        resolve({\n          webPath: URL.createObjectURL(photo),\n          format: format,\n          saved: false,\n        });\n      } else {\n        reader.readAsDataURL(photo);\n        reader.onloadend = () => {\n          const r = reader.result as string;\n          if (options.resultType === 'dataUrl') {\n            resolve({\n              dataUrl: r,\n              format: format,\n              saved: false,\n            });\n          } else {\n            resolve({\n              base64String: r.split(',')[1],\n              format: format,\n              saved: false,\n            });\n          }\n        };\n        reader.onerror = e => {\n          reject(e);\n        };\n      }\n    });\n  }\n\n  async checkPermissions(): Promise<PermissionStatus> {\n    if (typeof navigator === 'undefined' || !navigator.permissions) {\n      throw this.unavailable('Permissions API not available in this browser');\n    }\n\n    try {\n      // https://developer.mozilla.org/en-US/docs/Web/API/Permissions/query\n      // the specific permissions that are supported varies among browsers that implement the\n      // permissions API, so we need a try/catch in case 'camera' is invalid\n      const permission = await window.navigator.permissions.query({\n        name: 'camera',\n      });\n      return {\n        camera: permission.state,\n        photos: 'granted',\n      };\n    } catch {\n      throw this.unavailable(\n        'Camera permissions are not available in this browser',\n      );\n    }\n  }\n\n  async requestPermissions(): Promise<PermissionStatus> {\n    throw this.unimplemented('Not implemented on web.');\n  }\n}\n\nconst Camera = new CameraWeb();\n\nexport { Camera };\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}